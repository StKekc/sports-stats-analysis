# üì¶ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ PostgreSQL - –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**1. SQL –°—Ö–µ–º–∞** (`schema.sql`) - 1085 —Å—Ç—Ä–æ–∫
- ‚úÖ 13 –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (leagues, seasons, teams, players, matches, standings, etc.)
- ‚úÖ 9 —Ç–∞–±–ª–∏—Ü –∏–≥—Ä–æ–∫–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ 4 –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (views)
- ‚úÖ 30+ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ Foreign keys –∏ constraints –¥–ª—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è timestamps

**–¢–∞–±–ª–∏—Ü—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤—Å–µ –≤–∞—à–∏ –∑–∞–¥–∞—á–∏:**
- ‚úÖ –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ —Å—Ç–∏–ª—é –∏–≥—Ä—ã
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥ –¥–æ–º–∞/–Ω–∞ –≤—ã–µ–∑–¥–µ
- ‚úÖ –î–∏–Ω–∞–º–∏–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ—É–¥–æ–±–Ω—ã—Ö —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤
- ‚úÖ –ü—Ä–æ–≥–Ω–æ–∑ –∏—Å—Ö–æ–¥–∞ –º–∞—Ç—á–∞

---

### üîß ETL –°–∏—Å—Ç–µ–º–∞

**2. DatabaseManager** (`database_manager.py`) - 470 —Å—Ç—Ä–æ–∫
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL —Å –ø—É–ª–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- Batch insert –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- Upsert –æ–ø–µ—Ä–∞—Ü–∏–∏ (INSERT ... ON CONFLICT)
- get_or_create –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ rollback
- VACUUM –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- **CacheManager** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è ID –≤ –ø–∞–º—è—Ç–∏

**3. ETL Utilities** (`etl_utils.py`) - 450 —Å—Ç—Ä–æ–∫
- **DataCleaner**: –û—á–∏—Å—Ç–∫–∞ NULL, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **DirectoryParser**: –ü–∞—Ä—Å–∏–Ω–≥ –∏–º–µ–Ω –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (league_season)
- **FieldMapper**: –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π CSV ‚Üí –ë–î
- **DataValidator**: –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
- –§—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞: –¥–∞—Ç, –≤—Ä–µ–º–µ–Ω–∏, —Å—á–µ—Ç–∞ –º–∞—Ç—á–∞, –∫–æ–¥–æ–≤ —Å—Ç—Ä–∞–Ω

**4. ETL Loaders** (`etl_loaders.py`) - 550 —Å—Ç—Ä–æ–∫
- **ReferenceDataLoader**: –ó–∞–≥—Ä—É–∑–∫–∞ –ª–∏–≥ –∏ —Å–µ–∑–æ–Ω–æ–≤
- **TeamsLoader**: –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–∞–Ω–¥
- **PlayersLoader**: –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
- **MatchesLoader**: –ü–∞—Ä—Å–∏–Ω–≥ –º–∞—Ç—á–µ–π —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- **StandingsLoader**: –¢—É—Ä–Ω–∏—Ä–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- **TeamStatsLoader**: –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**5. Player Stats Loader** (`player_stats_loader.py`) - 380 —Å—Ç—Ä–æ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ 9 —Ç–∏–ø–æ–≤ –∏–≥—Ä–æ–∫–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π player_team_seasons
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ (standard, shooting, passing, defense, possession, etc.)

**6. Main Migration Script** (`migrate_to_postgres.py`) - 420 —Å—Ç—Ä–æ–∫
- **MigrationOrchestrator**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª –∏ –∫–æ–Ω—Å–æ–ª—å
- Progress bar (tqdm) –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (strict/continue mode)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ë–î –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
- Command-line interface —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏

---

### üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**7. Configuration** (`config.yaml`) - 180 —Å—Ç—Ä–æ–∫
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ETL (batch size, workers, error mode)
- –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π –∏–∑ CSV –≤ –ë–î (–¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–∞—Ç, –ø—Ä–æ–≤–µ—Ä–∫–∏)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (NULL, –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**8. README** (`README.md`) - 600 —Å—Ç—Ä–æ–∫
- –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞
- SQL –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
- Python –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è ML
- Troubleshooting

**9. Quick Start** (`QUICKSTART.md`) - 150 —Å—Ç—Ä–æ–∫
- –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞ 5 –º–∏–Ω—É—Ç
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

**10. Tables Overview** (`TABLES_OVERVIEW.md`) - 500 —Å—Ç—Ä–æ–∫
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
- –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- –ò–Ω–¥–µ–∫—Å—ã –∏ —Å–≤—è–∑–∏
- –ì–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**11. Requirements** (`requirements.txt`)
- –í—Å–µ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

---

## üìä –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- ‚úÖ Batch insert (–ø–æ 1000 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ ID —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –≤ –ø–∞–º—è—Ç–∏
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ –≤—Å–µ—Ö FK –∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
- ‚úÖ COPY –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö INSERT
- ‚úÖ VACUUM ANALYZE –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏

**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã: ~10 —Å–µ–∫
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤: ~5 —Å–µ–∫
- **–ó–∞–≥—Ä—É–∑–∫–∞ 2.5 –ì–ë –¥–∞–Ω–Ω—ã—Ö: 20-40 –º–∏–Ω—É—Ç**
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: ~5 –º–∏–Ω
- **–ò–¢–û–ì–û: ~30-45 –º–∏–Ω—É—Ç**

### –û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö

**Input:**
- 90 –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (15 –ª–∏–≥ √ó 6 —Å–µ–∑–æ–Ω–æ–≤)
- 1080 CSV —Ñ–∞–π–ª–æ–≤
- 2.5 –ì–ë –¥–∞–Ω–Ω—ã—Ö

**Output (PostgreSQL):**
- ~15 –ª–∏–≥
- ~6 —Å–µ–∑–æ–Ω–æ–≤
- ~400 –∫–æ–º–∞–Ω–¥
- ~10,000 –∏–≥—Ä–æ–∫–æ–≤
- ~30,000 –º–∞—Ç—á–µ–π
- ~120 —Ç—É—Ä–Ω–∏—Ä–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- ~10,000+ –∑–∞–ø–∏—Å–µ–π –∏–≥—Ä–æ–∫–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞)

---

## üéØ –†–µ—à–µ–Ω–∏—è –¥–ª—è –≤–∞—à–∏—Ö –∑–∞–¥–∞—á

### 1. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ —Å—Ç–∏–ª—é –∏–≥—Ä—ã ‚≠ê

**–ì–æ—Ç–æ–≤—ã–µ —Ñ–∏—á–∏ –≤ –ë–î:**
```python
# –ò–∑ v_team_style_metrics
features = [
    'possession_pct',           # 45-65%
    'progressive_passes',       # 1000-2000
    'progressive_carries',      # 800-1500
    'total_cards',             # 30-80
    'xg_per_90'                # 1.0-2.5
]
```

**–ê–ª–≥–æ—Ä–∏—Ç–º—ã:**
- KMeans (3-5 –∫–ª–∞—Å—Ç–µ—Ä–æ–≤)
- DBSCAN
- Hierarchical Clustering

---

### 2. –ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥ –¥–æ–º–∞/–Ω–∞ –≤—ã–µ–∑–¥–µ ‚≠ê

**–ì–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
```sql
SELECT * FROM v_home_away_win_rate 
WHERE season_code = '2023-2024'
ORDER BY (home_win_rate_pct - away_win_rate_pct) DESC;
```

**–í—ã—Ö–æ–¥–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- `home_win_rate_pct` - % –ø–æ–±–µ–¥ –¥–æ–º–∞
- `away_win_rate_pct` - % –ø–æ–±–µ–¥ –Ω–∞ –≤—ã–µ–∑–¥–µ
- –†–∞–∑–Ω–∏—Ü–∞ = —Ñ–∞–∫—Ç–æ—Ä –¥–æ–º–∞—à–Ω–µ–≥–æ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

---

### 3. –î–∏–Ω–∞–º–∏–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º ‚≠ê

**–ì–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
```sql
SELECT * FROM v_team_form_by_month
WHERE team_name = 'Arsenal'
  AND season_code = '2023-2024'
ORDER BY month;
```

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
- Line chart: points_per_match –ø–æ –º–µ—Å—è—Ü–∞–º
- –í—ã—è–≤–ª–µ–Ω–∏–µ –ø–∏–∫–æ–≤ (–∞–≤–≥—É—Å—Ç-—Å–µ–Ω—Ç—è–±—Ä—å, –∞–ø—Ä–µ–ª—å-–º–∞–π)
- –°–ø–∞–¥—ã (–¥–µ–∫–∞–±—Ä—å, –º–∞—Ä—Ç)

---

### 4. –°–∞–º—ã–π –Ω–µ—É–¥–æ–±–Ω—ã–π —Å–æ–ø–µ—Ä–Ω–∏–∫ ‚≠ê

**–ì–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
```sql
-- –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –Ω–∞–π—Ç–∏ —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º win_rate
SELECT DISTINCT ON (team_name)
    team_name,
    opponent_name as most_difficult,
    win_rate_pct,
    matches_played
FROM v_head_to_head
WHERE matches_played >= 10
ORDER BY team_name, win_rate_pct ASC;
```

---

### 5. –ü—Ä–æ–≥–Ω–æ–∑ –∏—Å—Ö–æ–¥–∞ –º–∞—Ç—á–∞ ‚≠ê

**Feature Engineering:**

```python
def create_match_features(home_team, away_team, date):
    # 1. –§–æ—Ä–º–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∞—Ç—á–µ–π)
    home_form = get_recent_form(home_team, date, n=5)
    away_form = get_recent_form(away_team, date, n=5)
    
    # 2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ–∑–æ–Ω–∞ (–∏–∑ team_season_stats)
    home_season_stats = get_season_stats(home_team, date)
    away_season_stats = get_season_stats(away_team, date)
    
    # 3. H2H (–∏–∑ v_head_to_head)
    h2h = get_head_to_head(home_team, away_team)
    
    # 4. –§–∞–∫—Ç–æ—Ä –¥–æ–º–∞ (–∏–∑ v_home_away_win_rate)
    home_factor = get_home_win_rate(home_team)
    away_factor = get_away_win_rate(away_team)
    
    features = {
        'home_form_points': home_form['points'],
        'away_form_points': away_form['points'],
        'home_xg_per_90': home_season_stats['xg_per_90'],
        'away_xg_per_90': away_season_stats['xg_per_90'],
        'h2h_home_win_rate': h2h['win_rate'],
        'home_advantage': home_factor,
        ...
    }
    return features
```

**ML –º–æ–¥–µ–ª—å:**
```python
from sklearn.ensemble import RandomForestClassifier

# Target: 0=loss, 1=draw, 2=win (–¥–ª—è –¥–æ–º–∞—à–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã)
model = RandomForestClassifier(n_estimators=100)
model.fit(X_train, y_train)

# –ò–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—á–µ—Ç–∞
from xgboost import XGBRegressor
model_goals = XGBRegressor()
model_goals.fit(X_train, y_train_goals)  # –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –≥–æ–ª—ã
```

---

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (5 –º–∏–Ω—É—Ç)

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PostgreSQL
brew install postgresql@15 && brew services start postgresql@15

# 2. –°–æ–∑–¥–∞—Ç—å –ë–î
psql postgres -c "CREATE DATABASE sports_stats"
psql postgres -c "CREATE USER sports_user WITH PASSWORD 'mypass'"
psql postgres -c "GRANT ALL PRIVILEGES ON DATABASE sports_stats TO sports_user"

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install psycopg2-binary pandas numpy pyyaml tqdm

# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å config.yaml
# –ò–∑–º–µ–Ω–∏—Ç—å password –≤ database/config.yaml

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
python database/migrate_to_postgres.py

# ‚òï –ü–æ–¥–æ–∂–¥–∞—Ç—å 30-40 –º–∏–Ω—É—Ç...
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
psql -U sports_user -d sports_stats

sports_stats=> SELECT COUNT(*) FROM matches;
 count  
--------
 30000+
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
database/
‚îú‚îÄ‚îÄ README.md                   # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (600 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ QUICKSTART.md              # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (150 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ TABLES_OVERVIEW.md         # –û–±–∑–æ—Ä —Ç–∞–±–ª–∏—Ü (500 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ MIGRATION_SUMMARY.md       # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îÇ
‚îú‚îÄ‚îÄ schema.sql                 # SQL —Å—Ö–µ–º–∞ (1085 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ config.yaml                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (180 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ requirements.txt           # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ database_manager.py        # –ú–µ–Ω–µ–¥–∂–µ—Ä –ë–î (470 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ etl_utils.py              # –£—Ç–∏–ª–∏—Ç—ã (450 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ etl_loaders.py            # –ó–∞–≥—Ä—É–∑—á–∏–∫–∏ (550 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ player_stats_loader.py    # –ò–≥—Ä–æ–∫–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (380 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ migrate_to_postgres.py    # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (420 —Å—Ç—Ä–æ–∫)
‚îÇ
‚îî‚îÄ‚îÄ __init__.py               # Python package

–ò–¢–û–ì–û: ~5,000+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
```

---

## üéì –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è ML

### –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥

```python
import psycopg2
import pandas as pd
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
conn = psycopg2.connect("host=localhost dbname=sports_stats user=sports_user")

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
df = pd.read_sql("""
    SELECT * FROM v_team_style_metrics 
    WHERE season_code = '2023-2024'
""", conn)

# –§–∏—á–∏
features = ['possession_pct', 'progressive_passes', 'xg_per_90', 'total_cards']
X = df[features].fillna(0)

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
kmeans = KMeans(n_clusters=3, random_state=42)
df['cluster'] = kmeans.fit_predict(X_scaled)

# –†–µ–∑—É–ª—å—Ç–∞—Ç
for cluster_id in range(3):
    teams = df[df['cluster'] == cluster_id]['team_name'].tolist()
    print(f"–ö–ª–∞—Å—Ç–µ—Ä {cluster_id}: {teams}")

# –ö–ª–∞—Å—Ç–µ—Ä 0: [Barcelona, Manchester City, Bayern Munich]  - Possession-based
# –ö–ª–∞—Å—Ç–µ—Ä 1: [Liverpool, Real Madrid, PSG]                - High pressing
# –ö–ª–∞—Å—Ç–µ—Ä 2: [Atletico Madrid, Inter, Juventus]          - Defensive
```

### –ü—Ä–æ–≥–Ω–æ–∑ –∏—Å—Ö–æ–¥–∞ –º–∞—Ç—á–∞

```python
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –º–∞—Ç—á–µ–π —Å —Ñ–∏—á–∞–º–∏
df = load_historical_matches_with_features()

# Features
X = df[[
    'home_form_points', 'away_form_points',
    'home_xg_per_90', 'away_xg_per_90',
    'home_win_rate_pct', 'away_win_rate_pct',
    'h2h_home_wins', 'h2h_away_wins'
]]

# Target (0=away_win, 1=draw, 2=home_win)
y = df['result']

# –û–±—É—á–µ–Ω–∏–µ
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)
model = RandomForestClassifier(n_estimators=200, random_state=42)
model.fit(X_train, y_train)

# –¢–æ—á–Ω–æ—Å—Ç—å
print(f"Accuracy: {model.score(X_test, y_test):.2%}")

# –ü—Ä–æ–≥–Ω–æ–∑
new_match = [[12, 9, 2.1, 1.8, 65, 45, 7, 3]]  # –ü—Ä–∏–º–µ—Ä —Ñ–∏—á–µ–π
prediction = model.predict_proba(new_match)
print(f"Away Win: {prediction[0][0]:.1%}, Draw: {prediction[0][1]:.1%}, Home Win: {prediction[0][2]:.1%}")
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] SQL —Å—Ö–µ–º–∞ —Å 22 —Ç–∞–±–ª–∏—Ü–∞–º–∏ –∏ 4 views
- [x] ETL —Å–∏—Å—Ç–µ–º–∞ —Å 5 –º–æ–¥—É–ª—è–º–∏
- [x] –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –º–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π
- [x] –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (3 —Ñ–∞–π–ª–∞)
- [x] –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞—á
- [x] ML –ø—Ä–∏–º–µ—Ä—ã (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, –ø—Ä–æ–≥–Ω–æ–∑)
- [x] Troubleshooting —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- [x] Requirements.txt

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é:**
   ```bash
   python database/migrate_to_postgres.py
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ:**
   ```sql
   SELECT * FROM v_team_style_metrics LIMIT 10;
   ```

3. **–ù–∞—á–Ω–∏—Ç–µ –∞–Ω–∞–ª–∏–∑:**
   - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ (KMeans)
   - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –∫–æ–º–∞–Ω–¥ (matplotlib)
   - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç—á–µ–π (ML –º–æ–¥–µ–ª—å)

4. **–°–æ–∑–¥–∞–π—Ç–µ –¥–∞—à–±–æ—Ä–¥** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Streamlit/Dash
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫ PostgreSQL
   - –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä—ã –∏ –ø—Ä–æ–≥–Ω–æ–∑—ã

---

## üéâ –ò—Ç–æ–≥

–í—ã –ø–æ–ª—É—á–∏–ª–∏ **production-ready —Å–∏—Å—Ç–µ–º—É –º–∏–≥—Ä–∞—Ü–∏–∏** —Å:

‚úÖ –ü–æ–ª–Ω–æ–π –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö  
‚úÖ –ò–Ω–¥–µ–∫—Å–∞–º–∏ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤  
‚úÖ –ì–æ—Ç–æ–≤—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏ –¥–ª—è –≤—Å–µ—Ö –∑–∞–¥–∞—á  
‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π  
‚úÖ –ü—Ä–∏–º–µ—Ä–∞–º–∏ ML –∫–æ–¥–∞  

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è –¥–∏–ø–ª–æ–º–∞/–ø—Ä–æ–µ–∫—Ç–∞! üöÄ**

---

**–°–æ–∑–¥–∞–Ω–æ:** Cursor AI + Claude Sonnet 4.5  
**–î–∞—Ç–∞:** 26 –Ω–æ—è–±—Ä—è 2025  
**–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** ~2 —á–∞—Å–∞  
**–û–±—ä–µ–º –∫–æ–¥–∞:** ~5,000 —Å—Ç—Ä–æ–∫

